<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Accounting</title>
    <link rel="stylesheet" href="accounting.css">
    <link rel="stylesheet" href="../../footer.css" />
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>

<body>
    <!-- Top Bar -->
    <header class="topbar">
        <img src="../../assets/menu-icon.svg" alt="Menu" class="menu-icon" id="menuToggle" />
        <div class="login-link">
            <div class="user-info">
                <div class="email">abcabc@gmail.com</div>
            </div>
            <a href="../profile/profile.html">
                <img src="../../assets/person-icon.svg" alt="Profile" class="person-icon" />
            </a>
        </div>
    </header>

    <div class="container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <nav class="menu">
                <a class="menu-item" href="../../index.html">TEZ ATQARU</a>
                <div class="menu-item with-children">
                    <span>Действия ЧСИ</span>
                    <div class="submenu">
                        <a href="/main/request/requests.html">Запросы</a>
                        <a href="#">Меры</a>
                    </div>
                </div>
                <a class="menu-item active" href="">Бухгалтерия</a>
                <a class="menu-item" href="../registerOfDebtors/registerOfDebtors.html">Реестр должников</a>
                <a class="menu-item" href="../statistics/statistics.html">Статистика</a>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="content">
            <div class="filter-buttons" style="margin-bottom: 10px;">
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <button class="segment-button active" data-target="accounting-view">Выписка</button>
                    <button class="segment-button" data-target="ais-view">AIS OIP</button>
                </div>
            </div>

            <!-- Accounting View -->
            <div id="accounting-view" class="view-section active">
                <div class="file-section">
                    <input type="text" class="file-name" value="file-name.xlsx" readonly>
                    <button class="upload-button">Загрузите файл</button>
                    <input type="file" class="file-input" style="display: none;" accept=".xls,.xlsx">
                </div>

                <div class="tables-container">
                    <!-- Excel Table -->
                    <div class="table-wrapper">
                        <div id="sheet-tabs" class="tabs"></div>
                        <div id="excel-wrapper">
                            <!-- Updated Excel Table in the Accounting View -->
                            <div id="excel-table">
                                <table>
                                    <colgroup>
                                        <col style="width: 100px"> <!-- Date -->
                                        <col style="width: 100px"> <!-- Debit -->
                                        <col style="width: 100px"> <!-- Credit -->
                                        <col style="width: 150px"> <!-- Statement -->
                                        <col style="width: 80px"> <!-- Doc Number -->
                                        <col style="width: 120px"> <!-- Counterparty Bank -->
                                        <col style="width: 120px"> <!-- Counterparty -->
                                        <col style="width: 100px"> <!-- BIN/IIN -->
                                        <col style="width: 120px"> <!-- Counterparty Account -->
                                        <col style="width: 180px"> <!-- Payment Purpose -->
                                        <col style="width: 120px"> <!-- Operation Name -->
                                        <col style="width: 120px"> <!-- AIS OIP Number -->
                                        <col style="width: 120px"> <!-- Debtor -->
                                        <col style="width: 120px"> <!-- Collector -->
                                        <col style="width: 100px"> <!-- CHSI Payment -->
                                    </colgroup>
                                    <thead>
                                        <tr>
                                            <th>Дата</th>
                                            <th>Выбытие</th>
                                            <th>Поступление</th>
                                            <th>Выписка</th>
                                            <th>№ док.</th>
                                            <th>Банк контрагента</th>
                                            <th>Контрагент</th>
                                            <th>БИН/ИИН</th>
                                            <th>Счет контрагента</th>
                                            <th>Назначение платежа</th>
                                            <th>Операция</th>
                                            <th>№ АИСОИП</th>
                                            <th>Должник</th>
                                            <th>Взыскатель</th>
                                            <th>Оплата ЧСИ</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>2025-08-01</td>
                                            <td>15,000</td>
                                            <td></td>
                                            <td>Выписка №1</td>
                                            <td>DOI</td>
                                            <td>Halv</td>
                                            <td>TOX</td>
                                            <td>123</td>
                                            <td>KZ1</td>
                                            <td>Оплата</td>
                                            <td>Платеж</td>
                                            <td>AIS</td>
                                            <td>Иванов</td>
                                            <td>Петров</td>
                                            <td>500</td>
                                        </tr>
                                        <tr>
                                            <td>2025-08-02</td>
                                            <td></td>
                                            <td>25,000</td>
                                            <td>Выписка №2</td>
                                            <td>DOI</td>
                                            <td>Kas</td>
                                            <td>ИП</td>
                                            <td>987</td>
                                            <td>KZ5</td>
                                            <td>Возврат</td>
                                            <td>Поступление</td>
                                            <td>AIS</td>
                                            <td>Сергеев</td>
                                            <td>Ким</td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td>2025-08-03</td>
                                            <td>10,000</td>
                                            <td></td>
                                            <td>Выписка №3</td>
                                            <td>DOI</td>
                                            <td>Fori</td>
                                            <td>TOX</td>
                                            <td>456</td>
                                            <td>KZ4</td>
                                            <td>Оплата</td>
                                            <td>Платеж</td>
                                            <td>AIS</td>
                                            <td>Нургазин</td>
                                            <td>Моисеев</td>
                                            <td>300</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Summary Table -->
                    <div id="summary-container" class="summary-wrapper"></div>
                </div>
            </div>

            <!-- AIS OIP View -->
            <div id="ais-view" class="view-section">
                <div id="ais-sheet-tabs" class="tabs"></div>
                <div id="ais-excel-wrapper">
                    <div id="ais-excel-table"></div>
                </div>
            </div>
        </main>
    </div>
    <div id="footer-container"></div>

    <!-- JS -->
    <script src="accounting.js"></script>
</body>

</html>